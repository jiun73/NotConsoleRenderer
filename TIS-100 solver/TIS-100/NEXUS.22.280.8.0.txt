@0
MOV RIGHT ACC
MOV 0 DOWN
MOV ACC DOWN

@1
S:MOV UP ACC
JNZ A
MOV 0 RIGHT
MOV RIGHT LEFT
JMP S
A:SUB 1
JEZ 1
JGZ 234
1:MOV 1 RIGHT
JMP S
234:MOV ACC DOWN
MOV 10 ACC
L:SUB 1
JGZ L

@2
S:MOV UP ACC
SAV
MOV LEFT ACC
JNZ N
SWP
MOV ACC LEFT
SWP
JMP S
N:MOV 0 DOWN
SWP
MOV ACC DOWN
SWP

@3


@4
#P (LEFT)
S:MOV ANY ACC
JEZ WRITE

#READ (1)
SWP
MOV ACC LAST
SWP
JMP S

#WRITE (0)
WRITE:MOV LAST ACC
SAV

@5
S:MOV UP ACC
SUB 2
JLZ 2
JEZ 3
MOV 1 LEFT#4
MOV LEFT DOWN
JMP S
2:MOV -1 DOWN
JMP S
3:MOV 1 RIGHT
MOV 1 LEFT
ADD RIGHT
ADD LEFT
MOV 0 LEFT
MOV ACC LEFT

@6
#Q (RIGHT)
S:MOV ANY ACC
JEZ WRITE

#READ (1)
SWP
MOV ACC LAST
SWP
JMP S

#WRITE (0)
WRITE:MOV LAST ACC
SAV

@7


@8
S:MOV RIGHT ACC
MOV ACC UP
JEZ W

MOV UP RIGHT
JMP S

W:MOV RIGHT UP

@9
MOV UP ACC
JLZ SWAP
MOV ACC DOWN
JRO -999
SWAP:MOV 1 RIGHT
MOV RIGHT ACC
MOV 0 RIGHT
MOV 1 LEFT
MOV LEFT RIGHT
MOV 0 LEFT
MOV ACC LEFT

@10
S:MOV LEFT ACC
MOV ACC UP
JEZ W

MOV UP LEFT
JMP S

W:MOV LEFT UP